language: go

go:
  - 1.4

env:
  global:
    - secure: "psgQo84YXKrhMg+S1PP8u0UnV1eDTMlsm8u7pgDYPOhcUZPTR3+JXLxpaGuYKleIWNKybf4eeNV3B+jHrtEDtSBhgr9Ht8+yCj2n3FYKwYMbof335O8N8msSl76Wg2ONnSW16vBH4p108alxdwMnXtD+gM6Qv2X9KP/tqepK+zAHkcuS/IMyXKrb/976yu1KQB7K0KcPO/HiSQxTl423wgibxunx54e8A7BtW4HqyU9i8h3cV4g8oZhl7LkdU2z7CnyGdyORU7FhXcdqFgLdPBeuHKSz5zs3LM2Cr3eBgA1pJe9/lpFtvpBt+H+dD2nNaPyEdHOWQabwt8nc+N3OQTFXSi/YyaVH47ZBv7p04fapNF/5XtYtql92TVo70Fa1gOfCp9pYCwHCqyhmYwIOHTrahm32qVZ/m37B0qO721k1k9PWIMnfQ4f1qugD2BRmuCSrZg3WDTKCg0CacI8YXlLZLbc7e6yhcNjL2NVTeBVkEyINVQBhqSKGOhmZwYQq8gxL7CXCwaLb5aK8ZzxoBXjaqb/3mcdsWQ0YASm3ELOyvXSCztImGrfq9pqH+RGXqKipVPnl40rh50jmC5iwD7/ufbLc2RYE2PsfCK7w2kBcok0IEYYyttoHDIde3eCaLv4fwV1yXiMR2RQ9chdcM3d+7fXNc85rRYa5LIpZnes="
    - secure: "I8FFNWtivBpitICU1aLAI2JY00T7gejMrxKFrS6bzXyC7DHsCaa+kQtw18J+ArwQaa4aTrBZh27vLZipS8XeroHAv3n/gb/cP5nuFTL/ER/aU7sLObXmyCc0pYKO3Bj5jiVWEalDPGKUxe0VS3IVT7qlZWbeu24jsFQxrEmfGX0lulJGBcFpo7DvfNV2OOnG9SIkzOwBU7ZGiKxiVI0gJGuJeKJzDXP39m2EdGsyISguhKvfHXmDPErifeoC9ez8n5IgvuqHZnN6tDSQE8h2H59+qPxXEo/Vk71Gy18zg60KxIjXjNeVWNQY4XL/DSbjSYFxz1GWPHdhgIJydvLE30mvpEAhiVEoQy174zqj9b2fv2ERn6SxpSLaTdinY1hRGg3eX8tkalX/mCg5ESOO4rFyzmfoZuTqDFv5/35E590djSVrWnxZHUy6o70upPOPmsXo2RRiWm2OJhrdCJ9/0h3zkCUzsNkYU8Z++E285JVtMhmggges2aM5uV9Esni/cnIlNKtOYJdq98Pun1hkzca4AFj+mM4Bnf2t5atmys52qmTvyppfqCOnxjRh2VwuGw2mj90bdIan60jKatGPJex5YzLwiBewlS33N4/glqst8Ejw1AkJZRvytXEeTp2Oqb62VlEXeDJtZVu/PqeLaDB50SeQV+l/xiWsJX+ek6k="

script: go test -v ./...

after_success:
    - "wget http://go-cli.s3-website-us-east-1.amazonaws.com/releases/latest/cf-cli_amd64.deb -qO temp.deb && sudo dpkg -i temp.deb"
    - "rm temp.deb"
    - "cf api https://api.run.pivotal.io"
    - "cf login --u $CF_USERNAME --p $CF_PASSWORD --o jamesclonk.io --s development"
    - "cf push"
    - "cf logout"

notifications:
  email:
    on_success: change
    on_failure: always
